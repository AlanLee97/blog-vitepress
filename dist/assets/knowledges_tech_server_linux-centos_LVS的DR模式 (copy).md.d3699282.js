import{_ as t,o as e,c as p,b as a}from"./app.d2d47940.js";const m=JSON.parse('{"title":"LVS的DR模式","description":"","frontmatter":{},"headers":[{"level":2,"title":"准备资源","slug":"准备资源","link":"#准备资源","children":[]},{"level":2,"title":"搭建步骤","slug":"搭建步骤","link":"#搭建步骤","children":[]}],"relativePath":"knowledges/tech/server/linux-centos/LVS的DR模式 (copy).md","lastUpdated":1678618356000}'),d={name:"knowledges/tech/server/linux-centos/LVS的DR模式 (copy).md"},r=a('<h1 id="lvs的dr模式" tabindex="-1">LVS的DR模式 <a class="header-anchor" href="#lvs的dr模式" aria-hidden="true">#</a></h1><h2 id="准备资源" tabindex="-1">准备资源 <a class="header-anchor" href="#准备资源" aria-hidden="true">#</a></h2><table><thead><tr><th>主机</th><th>ip</th><th>角色</th></tr></thead><tbody><tr><td>master</td><td>192.168.1.20</td><td>DR</td></tr><tr><td>node1</td><td>192.168.1.21</td><td>RS1</td></tr><tr><td>node2</td><td>192.168.1.22</td><td>RS2</td></tr></tbody></table><h2 id="搭建步骤" tabindex="-1">搭建步骤 <a class="header-anchor" href="#搭建步骤" aria-hidden="true">#</a></h2><p>1、 找一台主机作为DR（虚拟服务器），安装ipvsadm</p><p>a) Yum install ipvsadm</p><p>2、 在DR设置两个IP地址：</p><p>a) DIP: 192.168.1.134 ,设置静态ID</p><p>b) VIP:192.168.1.200 , ifconfig eth0:1 192.168.1.200/24</p><p>3、 找多台机器作为RS( apeche或者tomcat )</p><p>a) 两台：静态设置192.168.1.137</p><p>192.168.1.138</p><p>b) 修改报文源IP的设置，需要设置内核参数</p><p>i. echo 1 &gt; /proc/sys/net/ipv4/conf/eth0/arp_ignore</p><p>ii. echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore</p><p>iii. echo 2 &gt; /proc/sys/net/ipv4/conf/eth0/arp_announce</p><p>iv. echo 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce</p><p>c) 在两台机器（RS）上，设置网卡的别名IP：192.168.1.200</p><p>i. ifconfig lo:0 192.168.1.200 netmask 255.255.255.255 broadcast 192.168.1.200</p><p>d) 在两台机器（RS）上，添加一个路由</p><p>i. route add -host 192.168.1.200 dev lo:0</p><p>4、 DR上需要加一个路由设置：route add -host 192.168.1.200 dev eth0:1</p><p>5、 在RS 检查web服务是否正常</p><p>6、 在DR上使用ipvsadm添加集群服务</p><p>a) Ipvsadm –C</p><p>b) ipvsadm -A -t 192.168.1.200:80 -s wlc</p><p>c) ipvsadm -a -t 192.168.1.200:80 -r 192.168.1.137 -g -w 1</p><p>d) ipvsadm -a -t 192.168.1.200:80 -r 192.168.1.138 -g -w 1</p>',28),o=[r];function s(i,n,c,h,l,_){return e(),p("div",null,o)}const f=t(d,[["render",s]]);export{m as __pageData,f as default};
